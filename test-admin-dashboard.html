<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard Test</title>
    <link rel="stylesheet" href="../css/admin-dashboard.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-header {
            color: #333;
            border-bottom: 2px solid #007acc;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .status-pass {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-fail {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="test-section">
        <h1 class="test-header">Admin Dashboard Implementation Test</h1>
        <p>Testing the editable TV show fields and category configurations...</p>
        
        <div id="test-results"></div>
    </div>

    <div class="test-section">
        <h2 class="test-header">Sample Anime Category Table</h2>
        <div id="admin-content">
            <table class="data-table">
                <thead id="table-headers"></thead>
                <tbody id="table-body"></tbody>
            </table>
        </div>
    </div>

    <script src="../js/admin-dashboard.js"></script>
    <script>
        // Test the admin dashboard functionality
        class AdminTest {
            constructor() {
                this.testResults = [];
                this.runTests();
            }
            
            async runTests() {
                try {
                    // Test 1: Check if AdminDashboard class exists
                    this.test("AdminDashboard class exists", typeof AdminDashboard !== 'undefined');
                    
                    // Test 2: Create dashboard instance
                    const dashboard = new AdminDashboard();
                    this.test("AdminDashboard instance created", dashboard instanceof AdminDashboard);
                    
                    // Test 3: Check category configurations
                    const animeConfig = dashboard.categoryConfigs.anime;
                    this.test("Anime config exists", !!animeConfig);
                    this.test("Anime has lastWatchedField", animeConfig.lastWatchedField === 'LAST WATCHED');
                    this.test("Anime has seriesLengthField", animeConfig.seriesLengthField === 'Series Length');
                    this.test("Anime fields include LAST WATCHED", animeConfig.fields.includes('LAST WATCHED'));
                    this.test("Anime fields include Series Length", animeConfig.fields.includes('Series Length'));
                    
                    // Test 4: Check sunday morning config
                    const sundayMorningConfig = dashboard.categoryConfigs.sundaymorning;
                    this.test("Sunday Morning config exists", !!sundayMorningConfig);
                    this.test("Sunday Morning has lastWatchedField", sundayMorningConfig.lastWatchedField === 'LAST WATCHED');
                    this.test("Sunday Morning has seriesLengthField", sundayMorningConfig.seriesLengthField === 'Series Length');
                    
                    // Test 5: Check sunday night config
                    const sundayNightConfig = dashboard.categoryConfigs.sundaynight;
                    this.test("Sunday Night config exists", !!sundayNightConfig);
                    this.test("Sunday Night has lastWatchedField", sundayNightConfig.lastWatchedField === 'LAST WATCHED');
                    this.test("Sunday Night has seriesLengthField", sundayNightConfig.seriesLengthField === 'Series Length');
                    
                    // Test 6: Check loot config (should not have STATUS)
                    const lootConfig = dashboard.categoryConfigs.loot;
                    this.test("Loot config exists", !!lootConfig);
                    this.test("Loot does not have STATUS field", !lootConfig.fields.includes('STATUS'));
                    this.test("Loot has correct fields", 
                        lootConfig.fields.includes('text') && 
                        lootConfig.fields.includes('copies') && 
                        lootConfig.fields.includes('cost') && 
                        lootConfig.fields.includes('genre'));
                    
                    // Test 7: Check coop/pvp configs
                    const coopConfig = dashboard.categoryConfigs.coop;
                    this.test("Coop config exists", !!coopConfig);
                    this.test("Coop does not have STATUS field", !coopConfig.fields.includes('STATUS'));
                    this.test("Coop has game field", coopConfig.gameField === 'game');
                    
                    // Test 8: Test method existence
                    this.test("updateTableHeaders method exists", typeof dashboard.updateTableHeaders === 'function');
                    this.test("createTableRow method exists", typeof dashboard.createTableRow === 'function');
                    this.test("updateItemField method exists", typeof dashboard.updateItemField === 'function');
                    
                    // Test 9: Try to generate headers for anime
                    dashboard.currentCategory = 'anime';
                    const headersContainer = document.getElementById('table-headers');
                    if (headersContainer) {
                        dashboard.updateTableHeaders();
                        const headers = headersContainer.innerHTML;
                        this.test("Headers generated", headers.length > 0);
                        this.test("Last Watched header exists", headers.includes('Last Watched'));
                        this.test("Series Length header exists", headers.includes('Series Length'));
                    }
                    
                } catch (error) {
                    this.test(`Test execution error: ${error.message}`, false);
                }
                
                this.displayResults();
            }
            
            test(description, passed) {
                this.testResults.push({ description, passed });
            }
            
            displayResults() {
                const container = document.getElementById('test-results');
                let html = '';
                let passCount = 0;
                
                this.testResults.forEach(result => {
                    const statusClass = result.passed ? 'status-pass' : 'status-fail';
                    const statusText = result.passed ? 'PASS' : 'FAIL';
                    if (result.passed) passCount++;
                    
                    html += `
                        <div>
                            <span class="status-indicator ${statusClass}">${statusText}</span>
                            ${result.description}
                        </div>
                    `;
                });
                
                const totalTests = this.testResults.length;
                const overallStatus = passCount === totalTests ? 'status-pass' : 'status-fail';
                
                html = `
                    <div>
                        <span class="status-indicator ${overallStatus}">
                            ${passCount}/${totalTests} TESTS PASSED
                        </span>
                        Overall Implementation Status
                    </div>
                    <br>
                    ${html}
                `;
                
                container.innerHTML = html;
            }
        }
        
        // Run tests when page loads
        window.addEventListener('load', () => {
            new AdminTest();
        });
    </script>
</body>
</html>
