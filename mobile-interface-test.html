<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile ErgoArena Interface Test</title>
    <link rel="stylesheet" href="css/ErgoArena.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
        }
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
        }
        .test-status {
            background: #333;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
        }
        .test-section {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .mock-monster-container {
            background: #0a0a0a;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 300px;
            position: relative;
        }
        .mock-info-container, .mock-history-container, .mock-trivia-container {
            position: fixed;
            width: 100vw;
            height: 100vh;
            top: 0;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 20px;
            box-sizing: border-box;
            z-index: 150;
            transition: all 0.3s ease-in-out;
            overflow-y: auto;
            backdrop-filter: blur(5px);
        }
        .mock-info-container {
            left: -100vw;
        }
        .mock-history-container {
            right: -100vw;
        }
        .mock-trivia-container {
            top: -100vh;
        }
        .mobile-overlay-active.mock-info-container {
            left: 0;
        }
        .mobile-overlay-active.mock-history-container {
            right: 0;
        }
        .mobile-overlay-active.mock-trivia-container {
            top: 0;
        }
        .test-result {
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
            font-weight: bold;
        }
        .pass { background: #27ae60; color: white; }
        .fail { background: #e74c3c; color: white; }
        .test-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        .test-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .test-btn:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üì± Mobile ErgoArena Interface Test</h1>
        
        <div class="test-status">
            <strong>Screen Width:</strong> <span id="screenWidth"></span>px<br>
            <strong>Mobile Mode:</strong> <span id="mobileStatus"></span><br>
            <strong>Test Status:</strong> <span id="testStatus">Ready</span>
        </div>
        
        <div class="test-section">
            <h3>üîß CSS Mobile Rules Test</h3>
            <div id="cssTest" class="test-result">Testing...</div>
        </div>
        
        <div class="test-section">
            <h3>üì± Toggle Button Test</h3>
            <div class="test-actions">
                <button class="test-btn" onclick="testToggleButton()">Test Toggle Button</button>
                <button class="test-btn" onclick="testTogglePosition()">Test Position</button>
            </div>
            <div id="toggleTest" class="test-result">Click test buttons above</div>
        </div>
        
        <div class="test-section">
            <h3>üëÜ Swipe Gesture Test</h3>
            <div class="mock-monster-container" id="mockContainer">
                <h4>Swipe Test Area</h4>
                <p>‚ÜîÔ∏è Swipe left/right for info/history</p>
                <p>‚¨ÜÔ∏è Swipe up for trivia</p>
                <div id="swipeTest" class="test-result">Perform swipe gestures above</div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üéØ Container Overlay Test</h3>
            <div class="test-actions">
                <button class="test-btn" onclick="testInfoOverlay()">Show Info</button>
                <button class="test-btn" onclick="testHistoryOverlay()">Show History</button>
                <button class="test-btn" onclick="testTriviaOverlay()">Show Trivia</button>
                <button class="test-btn" onclick="hideAllOverlays()">Hide All</button>
            </div>
            <div id="overlayTest" class="test-result">Click test buttons above</div>
        </div>
    </div>
    
    <!-- Mock overlays for testing -->
    <div id="mockInfoContainer" class="mock-info-container">
        <h2>üìã Info Container Test</h2>
        <p>This is the info overlay test. It should slide in from the left.</p>
        <button onclick="hideAllOverlays()" style="background: #e74c3c; color: white; border: none; padding: 10px; border-radius: 5px;">Close</button>
    </div>
    
    <div id="mockHistoryContainer" class="mock-history-container">
        <h2>üìú History Container Test</h2>
        <p>This is the history overlay test. It should slide in from the right.</p>
        <button onclick="hideAllOverlays()" style="background: #e74c3c; color: white; border: none; padding: 10px; border-radius: 5px;">Close</button>
    </div>
    
    <div id="mockTriviaContainer" class="mock-trivia-container">
        <h2>üß† Trivia Container Test</h2>
        <p>This is the trivia overlay test. It should slide down from the top.</p>
        <button onclick="hideAllOverlays()" style="background: #e74c3c; color: white; border: none; padding: 10px; border-radius: 5px;">Close</button>
    </div>

    <script>
        // Test variables
        let touchStartX = 0, touchStartY = 0, touchEndX = 0, touchEndY = 0;
        let testResults = {
            css: false,
            toggle: false,
            position: false,
            swipe: false,
            overlays: false
        };
        
        // Update screen info
        function updateScreenInfo() {
            document.getElementById('screenWidth').textContent = window.innerWidth;
            document.getElementById('mobileStatus').textContent = window.innerWidth < 800 ? 'Active' : 'Inactive';
        }
        
        // Test CSS mobile rules
        function testCSSRules() {
            const testElement = document.createElement('div');
            testElement.setAttribute('id', 'infoContainer0');
            testElement.style.display = 'block';
            document.body.appendChild(testElement);
            
            const computedStyle = window.getComputedStyle(testElement);
            const isMobileWidth = window.innerWidth < 800;
            
            if (isMobileWidth) {
                const position = computedStyle.position;
                const left = computedStyle.left;
                const hasCorrectStyle = position === 'fixed' && left.includes('-100vw');
                
                document.getElementById('cssTest').textContent = hasCorrectStyle ? 
                    'PASS: Mobile CSS rules applied correctly' : 
                    `FAIL: Expected fixed/-100vw, got ${position}/${left}`;
                document.getElementById('cssTest').className = `test-result ${hasCorrectStyle ? 'pass' : 'fail'}`;
                testResults.css = hasCorrectStyle;
            } else {
                document.getElementById('cssTest').textContent = 'SKIP: Not in mobile viewport';
                document.getElementById('cssTest').className = 'test-result';
                testResults.css = true; // Skip on desktop
            }
            
            document.body.removeChild(testElement);
        }
        
        // Test toggle button functionality
        function testToggleButton() {
            // Check if mobile toggle button exists or can be created
            const existingButton = document.querySelector('.mobile-info-toggle');
            const isMobile = window.innerWidth < 800;
            
            if (isMobile) {
                const hasToggle = !!existingButton;
                document.getElementById('toggleTest').textContent = hasToggle ? 
                    'PASS: Mobile toggle button found' : 
                    'FAIL: Mobile toggle button not found';
                document.getElementById('toggleTest').className = `test-result ${hasToggle ? 'pass' : 'fail'}`;
                testResults.toggle = hasToggle;
            } else {
                document.getElementById('toggleTest').textContent = 'SKIP: Not in mobile viewport';
                document.getElementById('toggleTest').className = 'test-result';
                testResults.toggle = true;
            }
        }
        
        // Test toggle button position
        function testTogglePosition() {
            const toggleButton = document.querySelector('.mobile-info-toggle');
            const isMobile = window.innerWidth < 800;
            
            if (isMobile && toggleButton) {
                const style = window.getComputedStyle(toggleButton);
                const rightPosition = style.right;
                const hasCorrectPosition = rightPosition === '15px';
                
                document.getElementById('toggleTest').textContent = hasCorrectPosition ? 
                    'PASS: Toggle button positioned correctly (right: 15px)' : 
                    `FAIL: Expected right: 15px, got right: ${rightPosition}`;
                document.getElementById('toggleTest').className = `test-result ${hasCorrectPosition ? 'pass' : 'fail'}`;
                testResults.position = hasCorrectPosition;
            } else {
                document.getElementById('toggleTest').textContent = 'SKIP: No toggle button or not mobile';
                document.getElementById('toggleTest').className = 'test-result';
                testResults.position = true;
            }
        }
        
        // Test overlay functionality
        function testInfoOverlay() {
            const overlay = document.getElementById('mockInfoContainer');
            overlay.classList.add('mobile-overlay-active');
            document.getElementById('overlayTest').textContent = 'Info overlay activated';
            document.getElementById('overlayTest').className = 'test-result pass';
            testResults.overlays = true;
        }
        
        function testHistoryOverlay() {
            const overlay = document.getElementById('mockHistoryContainer');
            overlay.classList.add('mobile-overlay-active');
            document.getElementById('overlayTest').textContent = 'History overlay activated';
            document.getElementById('overlayTest').className = 'test-result pass';
            testResults.overlays = true;
        }
        
        function testTriviaOverlay() {
            const overlay = document.getElementById('mockTriviaContainer');
            overlay.classList.add('mobile-overlay-active');
            document.getElementById('overlayTest').textContent = 'Trivia overlay activated';
            document.getElementById('overlayTest').className = 'test-result pass';
            testResults.overlays = true;
        }
        
        function hideAllOverlays() {
            document.querySelectorAll('.mock-info-container, .mock-history-container, .mock-trivia-container')
                .forEach(overlay => overlay.classList.remove('mobile-overlay-active'));
            document.getElementById('overlayTest').textContent = 'All overlays hidden';
            document.getElementById('overlayTest').className = 'test-result';
        }
        
        // Swipe gesture testing
        function setupSwipeTest() {
            const container = document.getElementById('mockContainer');
            
            container.addEventListener('touchstart', (e) => {
                const touch = e.touches[0];
                touchStartX = touch.clientX;
                touchStartY = touch.clientY;
            });
            
            container.addEventListener('touchend', (e) => {
                const touch = e.changedTouches[0];
                touchEndX = touch.clientX;
                touchEndY = touch.clientY;
                
                const deltaX = touchEndX - touchStartX;
                const deltaY = touchEndY - touchStartY;
                const minSwipeDistance = 100;
                
                let swipeResult = '';
                
                if (deltaY < -minSwipeDistance && Math.abs(deltaX) < 150) {
                    swipeResult = 'PASS: Upward swipe detected (trivia)';
                    testTriviaOverlay();
                } else if (Math.abs(deltaY) <= 150) {
                    if (deltaX < -minSwipeDistance) {
                        swipeResult = 'PASS: Left swipe detected (info)';
                        testInfoOverlay();
                    } else if (deltaX > minSwipeDistance) {
                        swipeResult = 'PASS: Right swipe detected (history)';
                        testHistoryOverlay();
                    } else {
                        swipeResult = 'FAIL: Swipe too short';
                    }
                } else {
                    swipeResult = 'FAIL: Vertical movement too large';
                }
                
                document.getElementById('swipeTest').textContent = swipeResult;
                document.getElementById('swipeTest').className = `test-result ${swipeResult.includes('PASS') ? 'pass' : 'fail'}`;
                testResults.swipe = swipeResult.includes('PASS');
            });
        }
        
        // Update test status
        function updateTestStatus() {
            const passedTests = Object.values(testResults).filter(Boolean).length;
            const totalTests = Object.keys(testResults).length;
            document.getElementById('testStatus').textContent = `${passedTests}/${totalTests} tests passed`;
        }
        
        // Initialize tests
        window.addEventListener('load', () => {
            updateScreenInfo();
            testCSSRules();
            testToggleButton();
            setupSwipeTest();
            
            // Update on resize
            window.addEventListener('resize', () => {
                updateScreenInfo();
                testCSSRules();
                testToggleButton();
                updateTestStatus();
            });
            
            // Periodic status update
            setInterval(updateTestStatus, 1000);
        });
    </script>
</body>
</html>
