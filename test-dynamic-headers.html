<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Headers Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1a1a2e;
            color: white;
        }
        .test-section { 
            margin: 20px 0; 
            padding: 20px; 
            border: 1px solid #444; 
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
        }
        .test-result { 
            padding: 10px; 
            margin: 5px 0; 
            border-radius: 4px; 
        }
        .success { background: rgba(0,255,0,0.2); border: 1px solid green; }
        .error { background: rgba(255,0,0,0.2); border: 1px solid red; }
        .info { background: rgba(0,150,255,0.2); border: 1px solid #0096ff; }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 10px 0; 
        }
        th, td { 
            border: 1px solid #444; 
            padding: 8px; 
            text-align: left; 
        }
        th { background: rgba(255,255,255,0.1); }
        button { 
            padding: 10px 20px; 
            margin: 5px; 
            background: #6366f1; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
        }
        button:hover { background: #4338ca; }
    </style>
</head>
<body>
    <h1>üß™ Dynamic Table Headers Test</h1>
    
    <div class="test-section">
        <h2>Category Configuration Test</h2>
        <div id="config-test"></div>
    </div>
    
    <div class="test-section">
        <h2>Dynamic Header Generation Test</h2>
        <div>
            <label>Select Category: </label>
            <select id="category-select">
                <option value="movies">üé¨ Movies</option>
                <option value="coop">üéÆ CO-OP Games</option>
                <option value="singleplayer">üéØ Single Player Games</option>
                <option value="loot">üì¶ LOOT Boxes</option>
                <option value="anime">üéå Anime</option>
                <option value="youtube">üì∫ YouTube</option>
            </select>
            <button onclick="testHeaders()">Generate Headers</button>
        </div>
        <div id="header-test"></div>
    </div>
    
    <div class="test-section">
        <h2>Expected vs Generated Headers</h2>
        <div id="comparison-test"></div>
    </div>

    <script>        // Simulate the category configurations from admin-dashboard.js
        const categoryConfigs = {
            movies: {
                fields: ['STATUS', 'WATCHED'],
                timesSeenField: 'WATCHED',
                watchedField: 'WATCHED',
                showCopies: false
            },
            anime: {
                fields: ['STATUS', 'WATCHED'],
                timesSeenField: 'WATCHED',
                watchedField: 'WATCHED',
                showCopies: false
            },
            youtube: {
                fields: ['STATUS', 'WATCHED'],
                timesSeenField: 'WATCHED',
                watchedField: 'WATCHED',
                showCopies: false
            },            coop: {
                fields: ['STATUS', 'COMPLETED?', 'copies'],
                completedField: 'COMPLETED?',
                showCopies: true
            },
            pvp: {
                fields: ['STATUS', 'COMPLETED?', 'copies'],
                completedField: 'COMPLETED?',
                showCopies: true
            },
            singleplayer: {
                fields: ['STATUS', 'COMPLETED?', 'TIME TO BEAT'],
                completedField: 'COMPLETED?',
                timeField: 'TIME TO BEAT',
                showCopies: false
            },
            loot: {
                fields: ['STATUS', 'copies', 'cost'],
                copiesField: 'copies',
                costField: 'cost',
                showCopies: true
            }
        };

        // Test category configuration loading
        function testConfigurations() {
            const configDiv = document.getElementById('config-test');
            let html = '<h3>Category Configurations:</h3>';
            
            for (const [category, config] of Object.entries(categoryConfigs)) {
                html += `
                    <div class="test-result info">
                        <strong>${category}:</strong> ${config.fields.join(', ')}
                        ${config.showCopies ? ' (with copies)' : ''}
                        ${config.timesSeenField ? ' (times seen)' : ''}
                        ${config.completedField ? ' (completion)' : ''}
                        ${config.timeField ? ' (time to beat)' : ''}
                        ${config.costField ? ' (cost)' : ''}
                    </div>
                `;
            }
            
            configDiv.innerHTML = html;
        }

        // Simulate the header generation logic
        function generateHeaders(category) {
            const config = categoryConfigs[category];
            if (!config) return [];
            
            const isLoot = category === 'loot';
            let headers = ['Checkbox', 'Name', 'Status'];
            
            // Add category-specific headers
            if (config.showCopies) {
                headers.push('Copies');
            }
            
            if (config.completedField) {
                headers.push('Completed?');
            }
            
            if (config.timesSeenField) {
                headers.push('Times Seen üëÄ');
            }
            
            if (config.timeField && category === 'singleplayer') {
                headers.push('Time to Beat');
            }
            
            if (config.costField && isLoot) {
                headers.push('Cost üí∞');
            }
            
            headers.push('Actions');
            
            return headers;
        }

        // Test header generation
        function testHeaders() {
            const category = document.getElementById('category-select').value;
            const headers = generateHeaders(category);
            
            const testDiv = document.getElementById('header-test');
            testDiv.innerHTML = `
                <div class="test-result success">
                    <h4>Generated Headers for ${category}:</h4>
                    <table>
                        <thead>
                            <tr>
                                ${headers.map(h => `<th>${h}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="${headers.length}">Sample data row would appear here...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            
            // Update comparison test
            updateComparison(category, headers);
        }

        // Compare expected vs generated headers
        function updateComparison(category, generated) {
            const expected = {
                movies: ['Checkbox', 'Name', 'Status', 'Times Seen üëÄ', 'Actions'],
                coop: ['Checkbox', 'Name', 'Status', 'Copies', 'Completed?', 'Actions'],
                singleplayer: ['Checkbox', 'Name', 'Status', 'Completed?', 'Time to Beat', 'Actions'],
                loot: ['Checkbox', 'Name', 'Status', 'Copies', 'Cost üí∞', 'Actions'],
                anime: ['Checkbox', 'Name', 'Status', 'Times Seen üëÄ', 'Actions'],
                youtube: ['Checkbox', 'Name', 'Status', 'Times Seen üëÄ', 'Actions']
            };
            
            const expectedHeaders = expected[category] || [];
            const comparisonDiv = document.getElementById('comparison-test');
            
            let html = `<h4>Comparison for ${category}:</h4>`;
            html += `<table>
                <tr><th>Expected</th><th>Generated</th><th>Match</th></tr>
            `;
            
            const maxLength = Math.max(expectedHeaders.length, generated.length);
            for (let i = 0; i < maxLength; i++) {
                const exp = expectedHeaders[i] || 'N/A';
                const gen = generated[i] || 'N/A';
                const match = exp === gen ? '‚úÖ' : '‚ùå';
                html += `<tr><td>${exp}</td><td>${gen}</td><td>${match}</td></tr>`;
            }
            
            html += '</table>';
            
            const isMatch = JSON.stringify(expectedHeaders) === JSON.stringify(generated);
            html += `<div class="test-result ${isMatch ? 'success' : 'error'}">
                Overall Match: ${isMatch ? '‚úÖ PASS' : '‚ùå FAIL'}
            </div>`;
            
            comparisonDiv.innerHTML = html;
        }

        // Initialize tests
        document.addEventListener('DOMContentLoaded', () => {
            testConfigurations();
            testHeaders(); // Test with default selection
        });
    </script>
</body>
</html>
